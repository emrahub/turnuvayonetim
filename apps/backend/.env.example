# ================================================================
# AUTHENTICATION SYSTEM ENVIRONMENT VARIABLES
# ================================================================

# Node Environment
NODE_ENV=development

# Server Configuration
PORT=3003
ALLOWED_ORIGINS=http://localhost:3005,http://localhost:3003

# ================================================================
# DATABASE CONFIGURATION
# ================================================================

# PostgreSQL Database URL
DATABASE_URL="postgresql://username:password@localhost:5432/turnuvayonetim_dev"

# ================================================================
# JWT AUTHENTICATION CONFIGURATION
# ================================================================

# JWT Secrets (REQUIRED) - Generate strong random secrets
JWT_SECRET="your-super-secret-jwt-key-at-least-32-characters-long"
REFRESH_TOKEN_SECRET="your-super-secret-refresh-token-key-at-least-32-characters"

# Optional: RSA Key Pair for RS256 (Recommended for production)
# Generate with: openssl genrsa -out private.pem 2048 && openssl rsa -in private.pem -pubout -out public.pem
JWT_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\nYour RSA private key here\n-----END PRIVATE KEY-----"
JWT_PUBLIC_KEY="-----BEGIN PUBLIC KEY-----\nYour RSA public key here\n-----END PUBLIC KEY-----"

# ================================================================
# PASSWORD SECURITY
# ================================================================

# Optional: Password pepper for additional security
PASSWORD_PEPPER="your-random-pepper-string-for-extra-password-security"

# ================================================================
# REDIS CONFIGURATION (Optional)
# ================================================================

# Redis URL for session storage and token blacklisting
REDIS_URL="redis://localhost:6379"
REDIS_HOST="localhost"
REDIS_PORT="6379"
REDIS_PASSWORD=""
REDIS_DB="0"

# ================================================================
# EMAIL SERVICE CONFIGURATION (For verification and password reset)
# ================================================================

# SMTP Configuration
SMTP_HOST="smtp.gmail.com"
SMTP_PORT="587"
SMTP_SECURE="false"
SMTP_USER="your-email@gmail.com"
SMTP_PASS="your-app-password"

# Email Addresses
FROM_EMAIL="noreply@turnuvayonetim.com"
SUPPORT_EMAIL="support@turnuvayonetim.com"

# ================================================================
# RATE LIMITING CONFIGURATION
# ================================================================

# Login rate limiting
AUTH_RATE_LIMIT_WINDOW="15" # minutes
AUTH_RATE_LIMIT_MAX="5" # attempts per window

# Registration rate limiting
REGISTER_RATE_LIMIT_WINDOW="60" # minutes
REGISTER_RATE_LIMIT_MAX="5" # attempts per window

# Password reset rate limiting
PASSWORD_RESET_RATE_LIMIT_WINDOW="60" # minutes
PASSWORD_RESET_RATE_LIMIT_MAX="3" # attempts per window

# ================================================================
# SECURITY CONFIGURATION
# ================================================================

# Account lockout settings
MAX_LOGIN_ATTEMPTS="5"
LOCKOUT_DURATION="15" # minutes

# Session settings
MAX_SESSIONS_PER_USER="5"
SESSION_TIMEOUT="3600" # seconds (1 hour)
ABSOLUTE_SESSION_TIMEOUT="86400" # seconds (24 hours)

# Two-factor authentication
TWO_FACTOR_REQUIRED="false" # Set to true for production
TWO_FACTOR_ISSUER="TurnuvaYonetim"

# Email verification
EMAIL_VERIFICATION_REQUIRED="true"
EMAIL_VERIFICATION_EXPIRY="24" # hours

# Password reset
PASSWORD_RESET_EXPIRY="30" # minutes

# ================================================================
# AUDIT AND LOGGING
# ================================================================

# Log level
LOG_LEVEL="info" # debug, info, warn, error

# Audit log retention
AUDIT_LOG_RETENTION_DAYS="365"

# Security event alerting
SECURITY_ALERT_EMAIL="security@turnuvayonetim.com"
ENABLE_SECURITY_ALERTS="true"

# ================================================================
# DEVELOPMENT SETTINGS
# ================================================================

# Development-specific settings (only used when NODE_ENV=development)
DEV_SKIP_EMAIL_VERIFICATION="true"
DEV_EXTENDED_TOKEN_EXPIRY="true"
DEV_DISABLE_RATE_LIMITING="false"

# ================================================================
# MONITORING AND HEALTH CHECKS
# ================================================================

# Health check configuration
HEALTH_CHECK_PATH="/health"
ENABLE_METRICS="true"

# External monitoring
MONITORING_API_KEY="your-monitoring-service-api-key"

# ================================================================
# CORS AND SECURITY HEADERS
# ================================================================

# CORS settings
CORS_CREDENTIALS="true"
CORS_MAX_AGE="86400"

# Content Security Policy
CSP_REPORT_URI="/api/csp-report"

# ================================================================
# FEATURE FLAGS
# ================================================================

# Feature toggles
ENABLE_TWO_FACTOR="true"
ENABLE_SESSION_MANAGEMENT="true"
ENABLE_PASSWORD_BREACH_CHECKING="false"
ENABLE_DEVICE_FINGERPRINTING="true"
ENABLE_SUSPICIOUS_ACTIVITY_DETECTION="true"

# ================================================================
# INTEGRATION SETTINGS
# ================================================================

# External service URLs
WEBSOCKET_URL="ws://localhost:3003"
FRONTEND_URL="http://localhost:3005"

# Webhook URLs for external integrations
WEBHOOK_USER_CREATED=""
WEBHOOK_SECURITY_ALERT=""

# ================================================================
# BACKUP AND RECOVERY
# ================================================================

# Database backup settings
DB_BACKUP_ENABLED="true"
DB_BACKUP_SCHEDULE="0 2 * * *" # Daily at 2 AM
DB_BACKUP_RETENTION_DAYS="30"

# ================================================================
# PRODUCTION OVERRIDES
# ================================================================

# Production-specific settings (only used when NODE_ENV=production)
PROD_JWT_ALGORITHM="RS256"
PROD_TOKEN_EXPIRY="15m"
PROD_REFRESH_TOKEN_EXPIRY="7d"
PROD_MAX_LOGIN_ATTEMPTS="3"
PROD_LOCKOUT_DURATION="30"
PROD_REQUIRE_TWO_FACTOR="true"
PROD_STRICT_RATE_LIMITING="true"

# ================================================================
# DEPLOYMENT CONFIGURATION
# ================================================================

# Container/deployment settings
CONTAINER_PORT="3003"
HEALTH_CHECK_INTERVAL="30"
GRACEFUL_SHUTDOWN_TIMEOUT="10"

# Load balancer settings
TRUST_PROXY="true"
PROXY_DEPTH="1"

# ================================================================
# EXAMPLE GENERATED SECRETS
# ================================================================

# To generate secure secrets, run:
# node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"

# Example JWT_SECRET (DO NOT USE IN PRODUCTION):
# JWT_SECRET="a1b2c3d4e5f6789012345678901234567890abcdef1234567890abcdef123456"

# Example REFRESH_TOKEN_SECRET (DO NOT USE IN PRODUCTION):
# REFRESH_TOKEN_SECRET="fedcba0987654321098765432109876543210fedcba098765432109876543210"

# Example PASSWORD_PEPPER (DO NOT USE IN PRODUCTION):
# PASSWORD_PEPPER="spice-up-your-passwords-with-this-random-pepper-string"